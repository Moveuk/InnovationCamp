# 20220630 TIL

## ğŸ“ 3ì£¼ì°¨ ë‚´ìš© ì •ë¦¬

- javascript ajax : í˜ì´ì§€ ì¤€ë¹„
```javascript
$(document).ready(function () {
    listing();
});

function listing() {
    $('#cards-box').empty();
    $.ajax({
        type: "GET",
        url: "http://spartacodingclub.shop/web/api/movie",
        data: {},
        success: function (response) {
            // console.log(response);
            let rows = response['movies'];
            for (let i = 0; i < rows.length; i++) {
                let title = rows[i]['title'];
                let desc = rows[i]['desc'];
                let image = rows[i]['image'];
                let star = rows[i]['star'];
                let comment = rows[i]['comment'];

                let star_image = 'â­'.repeat(star)

                let temp_html = `<div class="col">
    <div class="card h-100">
        <img src="${image}"
             class="card-img-top" alt="...">
        <div class="card-body">
            <h5 class="card-title">${title}</h5>
            <p class="card-text">${desc}</p>
            <p>${star_image}</p>
            <p class="mycomment">${comment}</p>
        </div>
    </div>
</div>`;
                $('#cards-box').append(temp_html);
            }
        }
    })
    console.log('í™”ë©´ ë¡œë”© í›„ ì˜ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤');
}
```

<br>

- python
```python
print('hello donguk!!')
```

<br>

- python
```python
# ë³€ìˆ˜, ìë£Œí˜•, í•¨ìˆ˜, ì¡°ê±´ë¬¸, ë°˜ë³µë¬¸

# ë³€ìˆ˜
a = 2
b = 3
print(a + b)

a = 'dong'
b = 'uk'
print(a + b)


# ìë£Œí˜•
a_list = ['ì‚¬ê³¼', 'ë°°', 'ê°']
print(a_list[1]) # ë°°

a_list.append('ìˆ˜ë°•')
print(a_list) # ['ì‚¬ê³¼', 'ë°°', 'ê°', 'ìˆ˜ë°•']

a_dict = {'name':'bob','age':27}
print(a_dict['name']) # bob


# í•¨ìˆ˜
def sum(a,b):
    return a+b

result = sum(1,2)
print(result)


# ì¡°ê±´ë¬¸
def is_adult(age):
    if age > 20:
        print('ì„±ì¸ì…ë‹ˆë‹¤.')
    else:
        print('ì²­ì†Œë…„ì…ë‹ˆë‹¤.')

is_adult(25) # ì„±ì¸ì…ë‹ˆë‹¤.


# ë°˜ë³µë¬¸ : ë¦¬ìŠ¤íŠ¸ ì˜ˆì œ
fruits = ['ì‚¬ê³¼','ë°°','ë°°','ê°','ìˆ˜ë°•','ê·¤','ë”¸ê¸°','ì‚¬ê³¼','ë°°','ìˆ˜ë°•']

count = 0
for fruit in fruits: # íŒŒì´ì¬ í–¥í¬ë¬¸ ê°œë…
    if fruit == 'ì‚¬ê³¼':
        count += 1
print(count)

# ë°˜ë³µë¬¸ : ë”•ì…”ë„ˆë¦¬ ì˜ˆì œ
people = [{'name': 'bob', 'age': 20}, 
{'name': 'carry', 'age': 38},
{'name': 'john', 'age': 7},
{'name': 'smith', 'age': 17},
{'name': 'ben', 'age': 27}]

for person in people:
    if person['age'] > 20:
        print(person['name'])
```

<br>

- í¬ë¡¤ë§ì„ ìœ„í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
  - pycharm ì„¤ì • - í”„ë¡œì íŠ¸ - python ì¸í„°í”„ë¦¬í„° - `+ ë²„íŠ¼` í´ë¦­ - `requests` ê²€ìƒ‰ - `requests` íŒ¨í‚¤ì§€ ì„¤ì¹˜

<br>

- requests íŒ¨í‚¤ì§€ ì‚¬ìš©í•´ë³´ê¸°
```python
import requests # requests ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í•„ìš”

r = requests.get('http://spartacodingclub.shop/sparta_api/seoulair')
rjson = r.json()

rows = rjson['RealtimeCityAir']['row']

for row in rows:
    gu_name = row['MSRSTE_NM']
    gu_mise = row['IDEX_MVL']
    if gu_mise < 60:
        print(gu_name, gu_mise)
```

<br>

- ì›¹ìŠ¤í¬ë˜í•‘(í¬ë¡¤ë§) ê¸°ì´ˆ
  - `bs4` íŒ¨í‚¤ì§€ ì„¤ì¹˜ : ë°©ë²• ê¸°ì¡´ê³¼ ë™ì¼
  - chrome ê°œë°œì ë„êµ¬ì—ì„œ selector copyí•´ì„œ ì‚¬ìš©

- ë·°í‹°í’€ìˆ©ì„ ì´ìš©í•˜ì—¬ ë„¤ì´ë²„ ì˜í™” ë­í‚¹ì—ì„œ ì˜í™” ì œëª© ê¸ì–´ì˜¤ê¸°
```python
import requests
from bs4 import BeautifulSoup

headers = {'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
data = requests.get('https://movie.naver.com/movie/sdb/rank/rmovie.naver?sel=pnt&date=20210829',headers=headers)

soup = BeautifulSoup(data.text, 'html.parser')

# title = soup.select_one('#old_content > table > tbody > tr:nth-child(2) > td.title > div > a')
# print(title.text) # ë°¥ì •

movies = soup.select('#old_content > table > tbody > tr')

for movie in movies:
    a = movie.select_one('td.title > div > a')
    if a is not None:
        print(a.text)
```

<br>

- í€´ì¦ˆ : ìˆœìœ„ ì˜í™”ì œëª© ë³„ì  ìˆœìœ¼ë¡œ í”„ë¦°íŠ¸í•˜ê¸°
```python
for movie in movies:
    a = movie.select_one('td.title > div > a')
    if a is not None:
        title = a.text
        rank = movie.select_one('td:nth-child(1) > img')['alt']
        star = movie.select_one('td.point').text

        print(rank, title, star)
```

<br>

- DB ê°œê´„
  - SQL(MySQL) VS NoSQL(mongoDB)
  - SQL : ì •í•´ì ¸ ìˆëŠ” í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ë„£ëŠ” ë°©ì‹ìœ¼ë¡œ ì •ë¦¬ê°€ ì˜ë˜ì–´ìˆìŒ.
  - NoSQL : í–‰/ì—´ì´ ì •í˜•í™”ë˜ì–´ ìˆì§€ ì•Šê³  í™˜ê²½ì´ ê¸‰ë³€í•˜ëŠ” ìƒí™©ì—ì„œ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜ ê°€ëŠ¥í•¨.

- mongoDB Atlas í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ì²˜ë¦¬

<br>

- mongoDB ìƒì„±
  - ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš© : pymongo, dnspython
  - DB ì ‘ì† ë° db ìë™ ìƒì„±
```python
from pymongo import MongoClient
client = MongoClient('mongodb+srv://test:YUlHxMAFAVDwps7X@cluster0.8qrmv.mongodb.net/?retryWrites=true&w=majority')
db = client.mongoTest

doc = {
    'name':'bob',
    'age':27
}

db.users.insert_one(doc)
```

<br>

- mongoDB ë°ì´í„° ì¡°ì‘
```python
# ë°ì´í„° ì‚½ì…
db.users.insert_one({'name':'bobby','age':25})
db.users.insert_one({'name':'john','age':20})
db.users.insert_one({'name':'ann','age':22})

# ì €ì¥ - ì˜ˆì‹œ
doc = {'name':'bobby','age':21}
db.users.insert_one(doc)

# í•œ ê°œ ì°¾ê¸° - ì˜ˆì‹œ
user = db.users.find_one({'name':'bobby'})

# ì—¬ëŸ¬ê°œ ì°¾ê¸° - ì˜ˆì‹œ ( _id ê°’ì€ ì œì™¸í•˜ê³  ì¶œë ¥)
all_users = list(db.users.find({},{'_id':False}))

# ë°”ê¾¸ê¸° - ì˜ˆì‹œ
db.users.update_one({'name':'bobby'},{'$set':{'age':19}})

# ì§€ìš°ê¸° - ì˜ˆì‹œ
db.users.delete_one({'name':'bobby'})
```

<br>

- í¬ë¡¤ë§í•œ ì˜í™” ì •ë³´ë¥¼ dbì— ë„£ê¸°
```python
client = MongoClient('mongodb+srv://test:YUlHxMAFAVDwps7X@cluster0.8qrmv.mongodb.net/?retryWrites=true&w=majority')
db = client.mongoTest

for movie in movies:
    a = movie.select_one('td.title > div > a')
    if a is not None:
        title = a.text
        rank = movie.select_one('td:nth-child(1) > img')['alt']
        star = movie.select_one('td.point').text

        doc = {
            'title':title,
            'rank':rank,
            'star':star
        }

        db.movies.insert_one(doc)
```

<br>

- í€´ì¦ˆ
```python
# ì œëª©ì´ ê°€ë²„ë‚˜ì›€ì¸ ì˜í™”ì˜ ë³„ì  ë³´ì´ê¸°
movie = db.movies.find_one({'title':'ê°€ë²„ë‚˜ì›€'})
print(movie['star'])

# ê°€ë²„ë‚˜ì›€ì˜ ë³„ì ê³¼ ê°™ì€ ì˜í™” ì°¾ê¸°
movies = list(db.movies.find({'star':movie['star']},{'_id':False}))
print(movies)
for m in movies:
    print(m['title'])

# ê°€ë²„ë‚˜ì›€ì˜ ë³„ì ì„ ë¬¸ìì—´ 0ìœ¼ë¡œ ë§Œë“¤ê¸°
db.movies.update_one({'title':'ê°€ë²„ë‚˜ì›€'},{'$set':{'star':'0'}})
```

<br>

- ìˆ™ì œ : ì§€ë‹ˆ ë®¤ì§ì˜ 1~50ìœ„ ê³¡ì„ ìŠ¤í¬ë˜í•‘í•˜ê¸°
```python
import requests
from bs4 import BeautifulSoup

headers = {'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
data = requests.get('https://www.genie.co.kr/chart/top200?ditc=M&rtm=N&ymd=20210701',headers=headers)

soup = BeautifulSoup(data.text, 'html.parser')

songs = soup.select('#body-content > div.newest-list > div > table > tbody > tr')

for song in songs:
    rank = song.select_one('td.number').text[0:2].strip()
    title = song.select_one('td.info > a.title.ellipsis').text.strip()
    artist = song.select_one('td.info > a.artist.ellipsis').text
    if rank == '15':
        title = song.select_one('td.info > a.title.ellipsis')
        title.find('span').decompose()
        title = title.text.strip()

    print(rank, title, artist)

```


## ğŸ’¡ ìƒˆë¡œ ë°°ìš´ ê²ƒ.`

- python íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë°©ë²•
- ì›¹ìŠ¤í¬ë˜í•‘(í¬ë¡¤ë§) : beautifulsoup4 ì‚¬ìš©
- mongoDB ë°ì´í„° ì¡°ì‘

- ìˆ™ì œì—ì„œ `19ê¸ˆ` í‘œì‹œê°€ ë“¤ì–´ê°„ ê²ƒì„ í¬ë¡¤ë§ í•´ì˜¬ ë•Œ ë¬¸ì œê°€ ìƒê¹€. -> ë¬´ì‹í•œ ë°©ë²•ìœ¼ë¡œ ì œê±°í•˜ì—¬ ì²˜ë¦¬í•˜ì˜€ì§€ë§Œ ì¤‘ê°„ ê³µë°±ì„ ì¸ì§€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ë˜ì§€ ì •ê·œì‹ í˜¹ì€ `19ê¸ˆ`ì´ë¼ëŠ” ë‹¨ì–´ê°€ ì¡´ì¬í•  ë•Œ ì œëª©ë§Œ ë°›ì•„ì˜¬ ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•´ì£¼ì–´ì•¼ í• ë“¯í•¨.