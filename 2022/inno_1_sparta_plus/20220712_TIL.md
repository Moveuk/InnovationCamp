# 20220712 TIL

## ğŸ“ ì›¹ê°œë°œ í”ŒëŸ¬ìŠ¤ ê³¼ì • - 2ì£¼ì°¨ ë‚´ìš© ì •ë¦¬

- db ì ‘ê·¼ ë°©ì‹ : ë³¸ì¸ì€ ëª½ê³  db ipì£¼ì†Œë¥¼ ëª°ë¼ doc_connect ë¶€ë¶„ì—ì„œ ì£¼ì†Œë¥¼ ì°¾ì•„ ì‚¬ìš©í•¨.
```python
client = MongoClient('mongodb+srv://cluster0.8qrmv.mongodb.net/?retryWrites=true&w=majority', 27017, username="ì‚¬ìš©ìì´ë¦„", password="ë¹„ë°€ë²ˆí˜¸")
db = client.dbsparta_plus_week2
```

<br>

- íŠ¹ìˆ˜ë¬¸ìì— ëŒ€í•˜ì—¬ ì•„ìŠ¤í‚¤ ì½”ë“œë¡œ ë³€í™˜í•˜ê³  ë³€í™˜ ë¶ˆê°€ëŠ¥í•œ ê²ƒì€ ì œê±°.
- `|save` : html íƒœê·¸ê°€ ê¸°ëŠ¥í•˜ë„ë¡ íŒŒì´í”„ë¼ì¸ ê¸°ëŠ¥ ì¶”ê°€.
```html
{% if definition.example %}
    <span class="example">{{ definition.example.encode('ascii','ignore').decode('utf-8')|safe }}</span>
{% endif %}
```

<br>

- `status_give`ë¥¼ ë³€ìˆ˜(new, old)ë¡œ ì£¼ì–´ì„œ ê¸°ì¡´ì— ê°€ì§€ê³  ìˆëŠ” ë‹¨ì–´ì¸ì§€ ì²´í¬í•˜ê¸°

<br>

- `|tojson` : ì„œë²„ì—ì„œ ë°›ì€ ê°’ì„ json í˜•íƒœë¡œ ë³€í™˜(jinja2)
```javascript
let words = {{ words|tojson }}
```

<br>

- `scrollIntoView()` : scroll í•˜ì—¬ ë³´ì´ê²Œë” ì„¤ì •
```javascript
$(`#word-${word}`).addClass("highlight") // í•˜ì´ë¼ì´íŠ¸ css
$(`#word-${word}`)[0].scrollIntoView()  // ìŠ¤í¬ë¡¤ view
```

<br>

- `toLowerCase()` : ëŒ€ì†Œë¬¸ì êµ¬ë¶„í•˜ì—¬ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— lowercaseë¡œ ë§ì¶°ì„œ db ê²€ìƒ‰ì„ í•¨.
```javascript
let word = $("#input-word").val().toLowerCase()
```

<hr>

## ğŸ“ ì›¹ê°œë°œ í”ŒëŸ¬ìŠ¤ ê³¼ì • - 4ì£¼ì°¨ ë‚´ìš© ì •ë¦¬

### Bulma

#### Bulmaë€?
- Bootstrapê³¼ ë¹„êµ ([ê³µì‹ë¬¸ì„œ ì°¸ì¡°](https://bulma.io/alternative-to-bootstrap/))
    - Bootstrapì€ jQueryì„ ì¨ì„œ ì›¹ì‚¬ì´íŠ¸ì—ì„œì˜ ìƒí˜¸ì‘ìš©ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ë°˜ë©´, BulmaëŠ” ìˆœìˆ˜í•œ CSS í”„ë ˆì„ì›Œí¬ì´ê¸° ë•Œë¬¸ì— ê¸°ëŠ¥ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼í•˜ì§€ë§Œ ëŒ€ì‹  ë” ììœ ë¡­ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ê°€ëŠ¥í•´ìš”.
    - Bootstrapì€ ì»¤ë®¤ë‹ˆí‹°ê°€ ì»¤ì„œ í…Œë§ˆë‚˜ í”ŒëŸ¬ê·¸ì¸ ë“±ì´ ê°œë°œì´ ë§ì´ ë˜ì–´ìˆê³  ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì´ë‚˜ ì˜ˆì‹œ ë“±ì„ ì°¾ê¸° ì‰½ê³ , BulmaëŠ” ë¬¸ë²•ì´ ì§ê´€ì ì´ê³  Flexbox ë“± ìµœì‹ ê¸°ìˆ ì„ ë§ì´ ì¨ìš”!

#### ì˜ˆì‹œ

  Hero ë°°ë„ˆ, Section, Box, Media, Button(loading í‘œì‹œ)

![image](https://user-images.githubusercontent.com/84966961/178391183-93abc6aa-3a5c-4b08-96b6-963a6e41dce1.png)


<br>

### í”„ë¡œì íŠ¸ í™˜ê²½ ì„¤ì •

#### ì¸í„°í”„ë¦¬í„° ì„¸íŒ…

- Flask : ì„œë²„ë¥¼ ì‹¤í–‰ í•´ì•¼í•˜ë‹ˆ ë‹¹ì—°íˆ!
- pymongo : DB ì ‘ì† íŒ¨í‚¤ì§€
- dnspython : ì§ì ‘ ip ì ‘ì†ì´ ì•„ë‹Œ srv ì˜µì…˜?(í”„ë¡œí† ì½œ?)ìœ¼ë¡œ db ì ‘ì†í•˜ë ¤ë©´ í•„ìš”í•œ ë“¯ í•˜ë‹¤. ì¢€ ë” ë””í…Œì¼í•˜ê²Œ ëœ¯ì–´ë´ì•¼ í•  ë“¯ í•˜ë‹¤.
- PyJWT : ë²„ì „ ì—…ì´ ë˜ë©´ì„œ ê¸°ì¡´ ì½”ë“œê°€ ì•ˆë¨¹íˆë¯€ë¡œ `v 1.7.1`ë¡œ ë‚´ë ¤ì„œ ì‚¬ìš©í•˜ì

![image](https://user-images.githubusercontent.com/84966961/178392935-16f11384-7bbb-4f46-aaa6-393af7cc5639.png)

<br>

### íšŒì›ê°€ì… ê¸°ëŠ¥

#### í•´ì‹œí•¨ìˆ˜ë¡œ ì•”í˜¸í™”í•˜ê¸°

íŠ¹ì§•
 - ì–´ë–¤ ê°’ì„ ë„£ì–´ë„ ì¼ì •í•œ ê¸¸ì´(256 byte)ì˜ ê°’ì´ ë‚˜ì˜´
 - ì¡°ê¸ˆì˜ ì°¨ì´ë¡œë„ ê²°ê³¼ë¬¼ì— í° ë³€í™”ê°€ ìƒê¸°ë¯€ë¡œ ë³´ì•ˆì— ì¢‹ìŒ.

#### ì½”ë“œ ì˜ˆì‹œ

```python
import hashlib

  pw_hash = hashlib.sha256(pw_receive.encode('utf-8')).hexdigest() # ë°›ì€ pw ì•”í˜¸í™”
```

#### íšŒì›ê°€ì… í™•ì¸ ë° ì •ê·œí‘œí˜„ì‹


- ì •ê·œ í‘œí˜„ì‹
```javascript
function is_nickname(asValue) {
    var regExp = /^(?=.*[a-zA-Z])[-a-zA-Z0-9_.]{2,10}$/; 
    // ì•„ì´ë””ëŠ” 2-10ìì˜ ì˜ë¬¸ê³¼ ìˆ«ìì™€ ì¼ë¶€ íŠ¹ìˆ˜ë¬¸ì(._-)ë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.
    return regExp.test(asValue);
}

function is_password(asValue) {
    var regExp = /^(?=.*\d)(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%^&*]{8,20}$/;
    // ì˜ë¬¸ê³¼ ìˆ«ì ì¡°í•©ì˜ 8-20ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”. íŠ¹ìˆ˜ë¬¸ì(!@#$%^&*)ë„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
    return regExp.test(asValue);
}
```

- íšŒì›ê°€ì…ì‹œ í™•ì¸ ì½”ë“œ

```javascript
function sign_up() {
    let username = $("#input-username").val()
    let password = $("#input-password").val()
    let password2 = $("#input-password2").val()
    console.log(username, password, password2)


    if ($("#help-id").hasClass("is-danger")) {
        alert("ì•„ì´ë””ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.")
        return;
    } else if (!$("#help-id").hasClass("is-success")) {
        alert("ì•„ì´ë”” ì¤‘ë³µí™•ì¸ì„ í•´ì£¼ì„¸ìš”.")
        return;
    }

    if (password == "") {
        $("#help-password").text("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.").removeClass("is-safe").addClass("is-danger")
        $("#input-password").focus()
        return;
    } else if (!is_password(password)) {
        $("#help-password").text("ë¹„ë°€ë²ˆí˜¸ì˜ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”. ì˜ë¬¸ê³¼ ìˆ«ì í•„ìˆ˜ í¬í•¨, íŠ¹ìˆ˜ë¬¸ì(!@#$%^&*) ì‚¬ìš©ê°€ëŠ¥ 8-20ì").removeClass("is-safe").addClass("is-danger")
        $("#input-password").focus()
        return
    } else {
        $("#help-password").text("ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.").removeClass("is-danger").addClass("is-success")
    }
    if (password2 == "") {
        $("#help-password2").text("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.").removeClass("is-safe").addClass("is-danger")
        $("#input-password2").focus()
        return;
    } else if (password2 != password) {
        $("#help-password2").text("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.").removeClass("is-safe").addClass("is-danger")
        $("#input-password2").focus()
        return;
    } else {
        $("#help-password2").text("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.").removeClass("is-danger").addClass("is-success")
    }
    $.ajax({
        type: "POST",
        url: "/sign_up/save",
        data: {
            username_give: username,
            password_give: password
        },
        success: function (response) {
            alert("íšŒì›ê°€ì…ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤!")
            window.location.replace("/login")
        }
    });

}
```

### ë¡œê·¸ì¸ ê¸°ëŠ¥

#### JWTë€?

 JSON Web Tokenì˜ ì¤„ì„ë§ JSON ê°ì²´ë¡œ ì •ë³´ë¥¼ ì•ˆì •ì„±ìˆê²Œ ì „ë‹¬í•˜ëŠ” ì›¹ í‘œì¤€ì„ ë§í•œë‹¤.

 ê¸°ì¡´ ì„¸ì…˜/ì¿ í‚¤ ë°©ì‹ì—ì„œ ì§„í™”í•œ ë°©ì‹ìœ¼ë¡œ ë³´ì•ˆê³¼ ì•ˆì •ì„±ì— ë”ìš± ë›°ì–´ë‚˜ë‹¤.

 - ì¶”ê°€ë¡œ ì½ì–´ë³´ê¸° : https://tansfil.tistory.com/58?category=255594

#### ì½”ë“œ ì˜ˆì‹œ

```python
# id, ì•”í˜¸í™”ëœpwì„ ê°€ì§€ê³  í•´ë‹¹ ìœ ì €ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
result = db.user.find_one({'id': id_receive, 'pw': pw_hash})

# ì°¾ìœ¼ë©´ JWT í† í°ì„ ë§Œë“¤ì–´ ë°œê¸‰í•©ë‹ˆë‹¤.
if result is not None:
    # JWT í† í°ì—ëŠ”, payloadì™€ ì‹œí¬ë¦¿í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.
    # ì‹œí¬ë¦¿í‚¤ê°€ ìˆì–´ì•¼ í† í°ì„ ë””ì½”ë”©(=í’€ê¸°) í•´ì„œ payload ê°’ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    # ì•„ë˜ì—ì„  idì™€ expë¥¼ ë‹´ì•˜ìŠµë‹ˆë‹¤. ì¦‰, JWT í† í°ì„ í’€ë©´ ìœ ì €ID ê°’ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    # expì—ëŠ” ë§Œë£Œì‹œê°„ì„ ë„£ì–´ì¤ë‹ˆë‹¤. ë§Œë£Œì‹œê°„ì´ ì§€ë‚˜ë©´, ì‹œí¬ë¦¿í‚¤ë¡œ í† í°ì„ í’€ ë•Œ ë§Œë£Œë˜ì—ˆë‹¤ê³  ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.
    payload = {
        'id': id_receive,
        'exp': datetime.datetime.utcnow() + datetime.timedelta(seconds=5)
    }
    token = jwt.encode(payload, SECRET_KEY, algorithm='HS256').decode('utf-8') # ë²„ì „ì— ë”°ë¼ encode í˜¹ì€ decode ì‚¬ìš©ë²•ì´ ë‹¤ë¥¸ ê²ƒ ê°™ë‹¤.

    # tokenì„ ì¤ë‹ˆë‹¤.
    return jsonify({'result': 'success', 'token': token})
# ì°¾ì§€ ëª»í•˜ë©´
else:
    return jsonify({'result': 'fail', 'msg': 'ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'})
```

í´ë¼ì´ì–¸íŠ¸ ì¸¡

- ê¶ê¸ˆí•œ ì 
   - ajaxë¡œ ì†¡ì‹ í•˜ëŠ” pwëŠ” ì•”í˜¸í™” í•  í•„ìš” ì—†ëŠ”ê°€?(ì´ëŸ° ë³´ì•ˆ ì‚¬í•­ì„ í”„ë¡ íŠ¸ì—ì„œ ë‹¤ë£¨ëŠ” ê²ƒì¸ê°€?) -> ì´ ë¬¸ì œëŠ” https í”„ë¡œí† ì½œ í˜¹ì€ ì¸ì¦ì„œ?(SSL)ë¡œ í•´ê²°ì´ ê°€ëŠ¥í•œ ê²ƒì¸ê°€?
   - í† í°ì€ ì‹œê°„ì— ë”°ë¼ ëœë¤í•œ ê°’ìœ¼ë¡œ ì£¼ì–´ì§€ëŠ”ê°€?(í† í°ì€ ì¬ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥í•œì§€? ì—ì„œ ì‹œì‘ëœ ì˜ë¬¸ -> expired timeì„ ê°™ì´ ë³´ë‚´ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ìš© ë¶ˆê°€ëŠ¥í•¨.[ì°©ê°í•¨])

```javascript
function sign_in() {
    let username = $("#input-username").val()
    let password = $("#input-password").val()

    if (username == "") {
        $("#help-id-login").text("ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        $("#input-username").focus()
        return;
    } else {
        $("#help-id-login").text("")
    }

    if (password == "") {
        $("#help-password-login").text("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        $("#input-password").focus()
        return;
    } else {
        $("#help-password-login").text("")
    }
    $.ajax({
        type: "POST",
        url: "/sign_in",
        data: {
            username_give: username,
            password_give: password
        },
        success: function (response) {
            if (response['result'] == 'success') {
                $.cookie('mytoken', response['token'], {path: '/'});
                window.location.replace("/")
            } else {
                alert(response['msg'])
            }
        }
    });
}
```

#### cookie

request íŒ¨í‚¤ì§€ì—ëŠ” `request.form`, `request.args.get` ë§ê³ ë„ ì¿ í‚¤ ê´€ë¦¬ì— ëŒ€í•œ ë©”ì†Œë“œê°€ ì¡´ì¬í•œë‹¤. ì´ë¥¼ í†µí•´ home í˜ì´ì§€ì—ì„œ token(ì•”í˜¸í™” ëœ)ì„ ì¿ í‚¤ë¡œ ì €ì¥í•´ë‘ê³  ì´ë¥¼ ì„œë²„ì—ì„œ ë‹¤ì‹œ ë°›ì•„ decode í•˜ì—¬ í† í° ë‚´ë¶€ì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ ì‚¬ìš©í•œë‹¤.

ì œì´ì¿¼ë¦¬ë„ `$.cookie()`í˜•íƒœë¡œ ì‚¬ìš©í•œë‹¤.

#### ì½”ë“œ ì˜ˆì‹œ
```python
def home():
    token_receive = request.cookies.get('mytoken')
    try:
        payload = jwt.decode(token_receive, SECRET_KEY, algorithms=['HS256'])
        user_info = db.user.find_one({"id": payload['id']})
        return render_template('index.html', nickname=user_info["nick"])
    except jwt.ExpiredSignatureError:
        return redirect(url_for("login", msg="ë¡œê·¸ì¸ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤."))
    except jwt.exceptions.DecodeError:
        return redirect(url_for("login", msg="ë¡œê·¸ì¸ ì •ë³´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."))

```

```javascript
// ì¿ í‚¤ì— í† í° ì €ì¥
$.cookie('mytoken', response['token']);
```

#### ì‹¤ìŠµ

- `toggleClass()` : íŠ¹ì • í´ë˜ìŠ¤ë¥¼ í† ê¸€í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” ê²ƒ.
```javascript
function toggle_sign_up() {
    $("#sign-up-box").toggleClass("is-hidden")
    $("#div-sign-in-or-up").toggleClass("is-hidden")
    $("#btn-check-dup").toggleClass("is-hidden")
    $("#help-id").toggleClass("is-hidden")
    $("#help-password").toggleClass("is-hidden")
    $("#help-password2").toggleClass("is-hidden")
}
```

- bool í´ë˜ìŠ¤ í™œìš© : íŒŒì´ì¬ ì•„ì´ë”” ì¡´ì¬ ì²´í¬í•˜ê¸°
   - >>> bool(x)ì „ë‹¬í•œ ì¡°ê±´ í˜¹ì€ ìˆ«ìë¥¼ ê¸°ë°˜ìœ¼ë¡œ boolean(True/False)Â ê°’ì„ ëŒë ¤ì¤€ë‹¤. 
   - - __builtin__ moduleì— í¬í•¨ëœ class ë¡œÂ  class intì˜ subclass ì´ë‹¤.Â 
   - boolì€ í´ë˜ìŠ¤ì´ë¯€ë¡œ `.__str__()`ê³¼ ê°™ì€ methodë„ ì¡´ì¬í•œë‹¤.(strì¸ì§€ í™•ì¸ method)

```python
@app.route('/sign_up/check_dup', methods=['POST'])
def check_dup():
    username_receive = request.form['username_give']
    exists = bool(db.users.find_one({"username": username_receive}))
    return jsonify({'result': 'success', 'exists': exists})
```

<br>

### ë©”ì¸ í˜ì´ì§€

- onclick í™œìš© : ë°”ë¡œ ì œì´ì¿¼ë¦¬ ì‚¬ìš©
```html
<input id="input-post" class="input is-rounded" placeholder="ë¬´ìŠ¨ ìƒê°ì„ í•˜ê³  ê³„ì‹ ê°€ìš”?" onclick='$("#modal-post").addClass("is-active")'>    
```

#### í¬ìŠ¤íŒ…

- ëª¨ë‹¬ì°½ì˜ ë°ì´í„°ë¥¼ ë°›ì•„ì™€ì„œ post í•˜ê¸°
```javascript
function post() {
    let comment = $("#textarea-post").val()
    let today = new Date().toISOString()
    $.ajax({
        type: "POST",
        url: "/posting",
        data: {
            comment_give: comment,
            date_give: today
        },
        success: function (response) {
            $("#modal-post").removeClass("is-active")
						window.location.reload()
        }
    })
}
```

- post ëª©ë¡ ë°›ì•„ì˜¤ê¸°
```python
# í¬ìŠ¤íŒ… ëª©ë¡ ë°›ì•„ì˜¤ê¸°
        posts = list(db.posts.find({}).sort("date", -1).limit(20))
        # -1 : ë‚´ë¦¼ì°¨ìˆœ / .limit(20) : 20ê°œê¹Œì§€ ì°¾ì•„ì˜´.
        for post in posts:
            post["_id"] = str(post["_id"])
            # mongoDB ê³ ìœ ì˜ idë¥¼ str()ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤.
```
```javascript
function get_posts() {
    $("#post-box").empty() // í¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
    $.ajax({
        type: "GET",
        url: "/get_posts",
        data: {},
        success: function (response) {
            if (response["result"] == "success") {
                let posts = response["posts"]
                for (let i = 0; i < posts.length; i++) {
                    let post = posts[i]
                    let time_post = new Date(post["date"])
                    // í¬ìŠ¤íŠ¸ ì•„ì´ë”” ê¸°ì–µ
                    let html_temp = `<div class="box" id="${post["_id"]}"> 
                                        <article class="media">
                                            <div class="media-left">
                                                <a class="image is-64x64" href="/user/${post['username']}">
                                                    <img class="is-rounded" src="/static/${post['profile_pic_real']}"
                                                         alt="Image">
                                                </a>
                                            </div>
                                            <div class="media-content">
                                                <div class="content">
                                                    <p>
                                                        <strong>${post['profile_name']}</strong> <small>@${post['username']}</small> <small>${time_post}</small>
                                                        <br>
                                                        ${post['comment']}
                                                    </p>
                                                </div>
                                                <nav class="level is-mobile">
                                                    <div class="level-left">
                                                        <a class="level-item is-sparta" aria-label="heart" onclick="toggle_like('${post['_id']}', 'heart')">
                                                            <span class="icon is-small"><i class="fa fa-heart"
                                                                                           aria-hidden="true"></i></span>&nbsp;<span class="like-num">2.7k</span>
                                                        </a>
                                                    </div>

                                                </nav>
                                            </div>
                                        </article>
                                    </div>`
                    $("#post-box").append(html_temp)
                }
            }
        }
    })
}
```

#### í¬ìŠ¤íŒ… ì‹œê°„ 

- ê° ë¶„, ì‹œê°„, ì¼, ë…„ ì¤‘ì—

```javascript
function time2str(date) {
    let today = new Date()
    let time = (today - date) / 1000 / 60  // ë¶„

    if (time < 60) {
        return parseInt(time) + "ë¶„ ì „"
    }
    time = time / 60  // ì‹œê°„
    if (time < 24) {
        return parseInt(time) + "ì‹œê°„ ì „"
    }
    time = time / 24
    if (time < 7) {
        return parseInt(time) + "ì¼ ì „"
    }
    return `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`
}
```

<br>

#### ì¢‹ì•„ìš” í‘œì‹œ

- í´ë˜ìŠ¤ë¡œ í‘œì‹œí•¨

```javascript
function toggle_like(post_id, type) {
    console.log(post_id, type)
    let $a_like = $(`#${post_id} a[aria-label='heart']`)
    let $i_like = $a_like.find("i")
    if ($i_like.hasClass("fa-heart")) {
        $.ajax({
            type: "POST",
            url: "/update_like",
            data: {
                post_id_give: post_id,
                type_give: type,
                action_give: "unlike"
            },
            success: function (response) {
                console.log("unlike")
                $i_like.addClass("fa-heart-o").removeClass("fa-heart")
                $a_like.find("span.like-num").text(response["count"])
            }
        })
    } else {
        $.ajax({
            type: "POST",
            url: "/update_like",
            data: {
                post_id_give: post_id,
                type_give: type,
                action_give: "like"
            },
            success: function (response) {
                console.log("like")
                $i_like.addClass("fa-heart").removeClass("fa-heart-o")
                $a_like.find("span.like-num").text(response["count"])
            }
        })

    }
}
```

 - ê¸€ ëª©ë¡ ë¶ˆëŸ¬ì˜¬ë•Œ ì¢‹ì•„ìš” ê°¯ìˆ˜ë¥¼ ê°ê° ë¶ˆëŸ¬ì™€ì•¼í•¨(ë°˜ë³µë¬¸ ì•ˆì—)
```python
# ê° ì•„ì´ë””ê°€ ì¢‹ì•„ìš” ë˜ì–´ìˆëŠ” ê²ƒ ë¶ˆëŸ¬ì˜¤ê¸°
post["count_heart"] = db.likes.count_documents({"post_id": post["_id"], "type": "heart"})
# ë‚´ê°€ ì¢‹ì•„ìš” í•œ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸° : ìˆìœ¼ë©´ true ì—†ìœ¼ë©´ false
post["heart_by_me"] = bool(db.likes.find_one({"post_id": post["_id"], "type": "heart", "username": payload['id']}))
```

 - í´ë¼ì´ì–¸íŠ¸ í•˜íŠ¸ í‘œì‹œí•˜ê¸° ì‚¼í•­ì—°ì‚°ì ì••ì¶•

```javascript
let class_heart = post['heart_by_me'] ? "fa-heart": "fa-heart-o"
```

### ë¡œê·¸ì•„ì›ƒ

- ì¿ í‚¤ì˜ í† í°ì„ ì§€ìš´ë‹¤

```javascript
$.removeCookie('mytoken', {path: '/'});
alert('ë¡œê·¸ì•„ì›ƒ!')
window.location.href = "/login"
```

### í”„ë¡œí•„

- í”„ë¡œí•„ ìˆ˜ì • -> ëª¨ë‹¬ì°½ìœ¼ë¡œ ë˜‘ê°™ì´ í•´ê²°
- ì„œë²„ì—ì„œ ë³¸ì¸ í”„ë¡œí•„ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆëŠ” status ê°’ì„ ë§Œë“¤ì–´ ë³´ë‚´ì–´ jinja2 ì—”ì§„ì„ ì´ìš©í•´ ê°„ë‹¨í•˜ê²Œ `í”„ë¡œí•„ìˆ˜ì •`, `ë¡œê·¸ì•„ì›ƒ` ë²„íŠ¼ì„ ë³´ì´ë„ë¡ í˜¹ì€ ì•ˆë³´ì´ë„ë¡ í•œë‹¤.

<br>



## ğŸ’¡ ìƒˆë¡œ ë°°ìš´ ê²ƒ

