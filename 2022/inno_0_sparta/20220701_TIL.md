# 20220701 TIL

## ğŸ“ 4ì£¼ì°¨ ë‚´ìš© ì •ë¦¬

- Flask í”„ë ˆì„ì›Œí¬ : ì„œë²„ë¥¼ êµ¬ë™ì‹œì¼œì£¼ëŠ” í¸í•œ ì½”ë“œ ëª¨ìŒ. ì„œë²„ë¥¼ êµ¬ë™í•˜ë ¤ë©´ í•„ìš”í•œ ë³µì¡í•œ ì¼ë“¤ì„ ì‰½ê²Œ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆìŒ.
```python
from flask import Flask
app = Flask(__name__)

@app.route('/')
def home():
   return 'This is Home!'

if __name__ == '__main__':
   app.run('0.0.0.0',port=5000,debug=True)
```
- Flask ë””ë ‰í† ë¦¬ êµ¬ì¡°
  - static : css, img
  - templates : html
  - app.py

<br>

- render_template : ì„œë²„ì—ì„œ ê° í˜ì´ì§€ì˜ html ë Œë”ë§ì„ ë„ì™€ì£¼ëŠ” í•¨ìˆ˜
```python
from flask import Flask, render_template
app = Flask(__name__)

@app.route('/')
def home():
   return render_template('index.html')

if __name__ == '__main__':
   app.run('0.0.0.0',port=5000,debug=True)
```

<br>

- api ë§Œë“¤ê¸° : get, post ë°©ì‹
```javascript
// get ìš”ì²­
function get() {
    $.ajax({
        type: "GET",
        url: "/test?title_give=ë´„ë‚ ì€ê°„ë‹¤",
        data: {},
        success: function (response) {
            console.log(response)
        }
    })
}
```
```python
# get ìš”ì²­ í™•ì¸
@app.route('/test', methods=['GET'])
def test_get():
   title_receive = request.args.get('title_give')
   print(title_receive)
   return jsonify({'result':'success', 'msg': 'ì´ ìš”ì²­ì€ GET!'})
```
```javascript
// POST ìš”ì²­
function post() {
    $.ajax({
        type: "POST",
        url: "/test",
        data: {title_give: 'ë´„ë‚ ì€ê°„ë‹¤'},
        success: function (response) {
            console.log(response)
        }
    })
}
```
```python
# POST ìš”ì²­ í™•ì¸
@app.route('/test', methods=['POST'])
def test_post():
   title_receive = request.form['title_give']
   print(title_receive)
   return jsonify({'result':'success', 'msg': 'ì´ ìš”ì²­ì€ POST!'})
```

<br>

- í™”ì„± ë•… ì‚¬ê¸°
  - ë•… ì‚¬ê¸° ìš”ì²­
```javascript
// POST ìš”ì²­
function save_order() {
    let name = $('#name').val();
    let address = $('#address').val();
    let size = $('#size').val();
    $.ajax({
        type: 'POST',
        url: '/mars',
        data: {name_give: name, address_give: address, size_give: size},
        success: function (response) {
            alert(response['msg'])
            window.location.reload();
        }
    });
}
```
```python
# POST ìš”ì²­ í™•ì¸
@app.route("/mars", methods=["POST"])
def web_mars_post():
    name_receive = request.form['name_give']
    address_receive = request.form['address_give']
    size_receive = request.form['size_give']

    doc = {
        'name': name_receive,
        'address': address_receive,
        'size': size_receive
    }
    db.mars.insert_one(doc)

    return jsonify({'msg': 'ì£¼ë¬¸ ì™„ë£Œ!'})
```
  - ë•… êµ¬ë§¤ ë‚´ì—­ ë³´ì—¬ì£¼ê¸°
```javascript
// get ìš”ì²­
function show_order() {
    $.ajax({
        type: 'GET',
        url: '/mars',
        data: {},
        success: function (response) {
            let rows = response['orders']
            for (let i = 0; i < rows.length; i++) {
                let name = rows[i]['name'];
                let address = rows[i]['address'];
                let size = rows[i]['size'];

                let temp_html = `        <tr>
    <td>${name}</td>
    <td>${address}</td>
    <td>${size}</td>
</tr>`;
                $('#order-box').append(temp_html)
            }
        }
    });
}
```
```python
# get ìš”ì²­ í™•ì¸
@app.route("/mars", methods=["GET"])
def web_mars_get():
    order_list = list(db.mars.find({},{'_id':False}))
    return jsonify({'orders': order_list})
```

<br>

- ì˜í™” í‰ì  í”„ë¡œì íŠ¸
```python
@app.route("/movie", methods=["POST"])
def movie_post():
    url_receive = request.form['url_give']
    star_receive = request.form['star_give']
    comment_receive = request.form['comment_give']

    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
    data = requests.get(url_receive, headers=headers)

    soup = BeautifulSoup(data.text, 'html.parser')

    title = soup.select_one('meta[property="og:title"]')['content']
    image = soup.select_one('meta[property="og:image"]')['content']
    desc = soup.select_one('meta[property="og:description"]')['content']

    doc = {
        'title':title,
        'image':image,
        'desc':desc,
        'star':star_receive,
        'comment':comment_receive
    }
    db.movies.insert_one(doc)
    return jsonify({'msg': 'ì €ì¥ ì™„ë£Œ!'})

@app.route("/movie", methods=["GET"])
def movie_get():
    movie_list = list(db.movies.find({},{'_id':False}))
    return jsonify({'movies': movie_list})
```
```javascript
function listing() {
    $.ajax({
        type: 'GET',
        url: '/movie',
        data: {},
        success: function (response) {
            let rows = response['movies']
            for (let i = 0; i < rows.length; i++) {
                let title = rows[i]['title'];
                let star = rows[i]['star'];;
                let comment = rows[i]['comment'];;
                let image = rows[i]['image'];
                let desc = rows[i]['desc'];

                let star_image = 'â­'.repeat(star)

                let temp_html = `        <div class="col">
    <div class="card h-100">
        <img src="${image}"
             class="card-img-top">
        <div class="card-body">
            <h5 class="card-title">${title}</h5>
            <p class="card-text">${desc}</p>
            <p>${star_image}</p>
            <p class="mycomment">${comment}</p>
        </div>
    </div>
</div>`
                $('#cards-box').append(temp_html);
            }
        }
    })
}

function posting() {
    let url = $('#url').val();
    let star = $('#star').val();
    let comment = $('#comment').val();

    $.ajax({
        type: 'POST',
        url: '/movie',
        data: {url_give: url, star_give:star, comment_give:comment},
        success: function (response) {
            alert(response['msg'])
        }
    });
}
```

<br>

- ìˆ™ì œ : íŒ¬ëª…ë¡ ì™„ì„±í•˜ê¸°
![image](https://user-images.githubusercontent.com/84966961/176853033-a2baac9c-5734-4031-94b6-c6f7b625dfe5.png)



## ğŸ’¡ ìƒˆë¡œ ë°°ìš´ ê²ƒ.`

- Flask ì‚¬ìš©