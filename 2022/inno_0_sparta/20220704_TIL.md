# 20220705 TIL

## ğŸ“ 5ì£¼ì°¨ ë‚´ìš© ì •ë¦¬

- filezilla ì„¤ì¹˜
- gabiaì—ì„œ ë„ë©”ì¸ êµ¬ë§¤(shopì€ 500ì›)

<br>

- bucketlist í”„ë¡œì íŠ¸
```python
@app.route("/bucket", methods=["POST"])
def bucket_post():
    bucket_receive = request.form['bucket_give']

    bucket_list = list(db.bucket.find({}, {'_id': False}))
    count = len(bucket_list) + 1

    doc = {'num': count,
           'bucket': bucket_receive,
           'done': 0
           }
    db.bucket.insert_one(doc)

    return jsonify({'msg': 'ë“±ë¡ ì™„ë£Œ!'})

@app.route("/bucket/done", methods=["POST"])
def bucket_done():
    num_receive = request.form['num_give']

    db.bucket.update_one({'num': int(num_receive)}, {'$set': {'done': 1}})
    return jsonify({'msg': 'ë²„í‚· ì™„ë£Œ!'})

@app.route("/bucket", methods=["GET"])
def bucket_get():
    bucket_list = list(db.bucket.find({},{'_id':False}))

    return jsonify({'buckets': bucket_list})
```
```javascript
        function show_bucket() {
            $.ajax({
                type: "GET",
                url: "/bucket",
                data: {},
                success: function (response) {
                    let rows = response['buckets']
                    console.log(rows)
                    for (let i = 0; i < rows.length; i++) {
                        let bucket = rows[i]['bucket']
                        let num = rows[i]['num']
                        let done = rows[i]['done']

                        let temp_html = ``
                        if (done == 0) {
                            temp_html = `    <li>
                                                <h2>âœ… ${bucket}</h2>
                                                <button onclick="done_bucket(${num})" type="button" class="btn btn-outline-primary">ì™„ë£Œ!</button>
                                            </li>`;
                        } else {
                            temp_html = `    <li>
                                                <h2 class="done">âœ… ${bucket}</h2>
                                            </li>`;
                        }

                        $('#bucket-list').append(temp_html)
                    }
                }
            });
        }

        function save_bucket() {
            let bucket = $('#bucket').val()

            $.ajax({
                type: "POST",
                url: "/bucket",
                data: {'bucket_give': bucket},
                success: function (response) {
                    alert(response["msg"])
                    window.location.reload()
                }
            });
        }

        function done_bucket(num) {
            $.ajax({
                type: "POST",
                url: "/bucket/done",
                data: {num_give: num},
                success: function (response) {
                    alert(response["msg"])
                    window.location.reload()
                }
            });
        }
```

<br>

- ì‹¤ì œ ë°°í¬
  - ì„œë²„ì˜ ì¡°ê±´
    - í•­ìƒ ì¼œì ¸ìˆì–´ì•¼í•¨.
    - ëª¨ë‘ê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê³µê°œ ì£¼ì†Œì¸ ê³µê°œ IP ì£¼ì†Œ(Public IP Address)ë¡œ ë‚˜ì˜ ì›¹ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì•¼í•¨.
  - ìµœê·¼ì—ëŠ” í´ë¼ìš°ë“œ ì„œë²„ ì„œë¹„ìŠ¤ë¥¼ í™œìš©í•¨ì— ë”°ë¼ íŠ¸ë˜í”½ ëŒ€ì‘ì´ ì‰¬ì›Œì¡Œë‹¤. -> AWS

<br>

- git bashì—ì„œ AWS EC2 ìš°ë¶„íˆ¬ ì›ê²© ì ‘ì†
```commandline
ssh -i ê°œì¸í‚¤íŒŒì¼ê²½ë¡œ.pem ubuntu@í¼ë¸”ë¦­ IPv4 ì£¼ì†Œ
```

<br>

- ìš°ë¶„íˆ¬ ì„œë²„ ì„¸íŒ…
```text
# python3 -> python : python ì•½ì–´ ì„¤ì •
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3 10

# pip3 -> pip : íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €? ì—­í•  ì„¤ì¹˜
sudo apt-get update
sudo apt-get install -y python3-pip
sudo update-alternatives --install /usr/bin/pip pip /usr/bin/pip3 1

# port forwarding : í¬íŠ¸ 5000ë²ˆ ëª…ì‹œ ë–¼ê¸°
sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 5000
```

<br>

- ìš°ë¶„íˆ¬ ì„œë²„ SFTP ì ‘ì†(íŒŒì¼ì§ˆë¼ í™œìš©)

<br>

- ìš°ë¶„íˆ¬ ì„œë²„ ì„¸íŒ…
  - í”„ë¡œì íŠ¸ SFTP ì „ì†¡
![image](https://user-images.githubusercontent.com/84966961/177071090-fd0f5b82-e136-4b8b-b226-19e751b1040f.png)
  - í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
```commandline
  pip install flask : ì„œë²„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
  pip install pymongo : MongoDB ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
  pip install dnspython : dns ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
```

<br>

- AWS EC2 ë³´ì•ˆê·¸ë£¹ 5000, 80 í¬íŠ¸ open
  - ë³´ì•ˆ ê·¸ë£¹ì—ì„œ ê·œì¹™ ì¶”ê°€í•˜ê¸° `anywhere IPv4`

<br>

- ì›ê²© ì ‘ì†ì„ ë„ë”ë¼ë„ ì„œë²„ê°€ ì‚´ì•„ìˆë„ë¡ ì„¤ì •í•˜ê¸°
```commandline

# nohup
nohup python app.py &

# ê°•ì œì¢…ë£Œ
ps -ef | grep 'python app.py' | awk '{print $2}' | xargs kill
```

<br>

- ë„ë©”ì¸ ì—°ê²°í•˜ê¸°
  - ê°€ë¹„ì•„ì—ì„œ dns ì—°ë™ ì„¤ì • í•´ì£¼ë©´ ë¨.

<br>

- og íƒœê·¸ ì„¤ì •
  - í—¤ë”ì— ë„£ì–´ì£¼ë©´ ë¨.
```html
<meta property="og:title" content="ë‚´ ì‚¬ì´íŠ¸ì˜ ì œëª©" />
<meta property="og:description" content="ë³´ê³  ìˆëŠ” í˜ì´ì§€ì˜ ë‚´ìš© ìš”ì•½" />
<meta property="og:image" content="ì´ë¯¸ì§€URL" />
```

- í˜ì´ìŠ¤ë¶ì´ë‚˜ ì¹´ì¹´ì˜¤í†¡ ê°™ì€ ì—…ì²´ì—ì„œëŠ” og íƒœê·¸ë¥¼ ì‹¤ì‹œê°„ í¬ë¡¤ë§ í•´ì˜¬ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ìµœì´ˆ ì €ì¥ í›„ ìˆ˜ì •í•˜ê³  ì‹¶ì„ ë•ŒëŠ” ê° ê°œë°œì í™ˆí˜ì´ì§€ì—ì„œ ì´ˆê¸°í™”ë¥¼ í•´ì£¼ì–´ ë‹¤ì‹œ í¬ë¡¤ë§ í•´ì˜¬ ìˆ˜ ìˆë„ë¡ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.
  - í˜ì´ìŠ¤ë¶ og íƒœê·¸ ì´ˆê¸°í™” í•˜ê¸°: [https://developers.facebook.com/tools/debug/](https://developers.facebook.com/tools/debug/)
  - ì¹´ì¹´ì˜¤í†¡ og íƒœê·¸ ì´ˆê¸°í™” í•˜ê¸°: [https://developers.kakao.com/tool/clear/og](https://developers.kakao.com/tool/clear/og)

<br>

## ğŸ’¡ ìƒˆë¡œ ë°°ìš´ ê²ƒ

- ì„œë²„ ì„¸íŒ…

- port forwarding
  - 80 port : AWS EC2 ë¦¬ëˆ…ìŠ¤ í¬íŠ¸
  - 5000 port : ìš°ë¦¬ ì„œë²„ í”„ë¡œì íŠ¸ flask í¬íŠ¸
```commandline
# port forwarding
sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 5000
```

- ë„ë©”ì¸ ì—°ê²° : ê°€ë¹„ì•„ êµ¬ë§¤ í›„ ë³¸ì¸ ì„œë²„ ì—°ë™

- og íƒœê·¸ : ì›¹ í˜ì´ì§€ì— ëŒ€í•œ ìš”ì•½ ì •ë³´ ê°œë….
  - ê° í¬ë¡¤ë§ í•´ê°€ëŠ” ì„œë¹„ìŠ¤ ì—…ì²´ì—ì„œ ì´ˆê¸°í™”ë¥¼ í•´ì£¼ê³  ìˆ˜ì •ì„ í•´ì£¼ì–´ì•¼ ë°”ë¡œ ì—°ë™ì´ ëœë‹¤.