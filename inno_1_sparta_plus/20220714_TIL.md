# 20220714 TIL

## ğŸ“ ì›¹ê°œë°œ í”ŒëŸ¬ìŠ¤ ê³¼ì • - 3ì£¼ì°¨ ë‚´ìš© ì •ë¦¬

### ì›¹ í¬ë¡¤ë§ vs ì›¹ ìŠ¤í¬ë¦¬í•‘

 í•œêµ­ì—ì„œëŠ” ì´ ë‘ ìš©ì–´ë¥¼ í˜¼ìš©í•˜ì—¬ ì“°ëŠ” ë²•ì´ ë§ë‹¤ê³  í•œë‹¤. ì‹¤ì œë¡œ ê·¸ë˜ì„œ ìµœê·¼ velog ê¸€ì—ì„œë„ ì‚¬ëŒë“¤ì´ ìƒê°í•˜ëŠ” ì›¹ í¬ë¡¤ë§ ì •ì˜ì— ëŒ€í•œ ë¶ˆë§Œ?ì„ í‘œì¶œí•˜ëŠ” ê¸€ë„ ë³´ì•˜ë‹¤. ì‚¬ì‹¤ì€ ë¶ˆë§Œì´ë¼ê¸°ë³´ë‹¤ ì›¹ í¬ë¡¤ë§ì´ë¼ê³  í‘œí˜„í•˜ë‚˜ ê²°êµ­ì€ ë‹¨ìˆœ ìŠ¤í¬ë˜í•‘ ìˆ˜ì¤€ì— ê±¸ì¹˜ëŠ” ê³ ë„í™” ë˜ì§€ ì•Šì€ ì €ìˆ˜ì¤€ì˜ ì½”ë“œ ë©ì´ì— ëŒ€í•œ ì´ì•¼ê¸°ì¸ ê²ƒ ê°™ì•˜ë‹¤. í•´ë‹¹ velogì„ ì•„ë˜ì— ì²¨ë¶€í•œë‹¤.

-> [`ì›¹ í¬ë¡¤ëŸ¬` ì¢€ ê·¸ë§Œ ë§Œë“¤ì–´ë¼](https://velog.io/@mowinckel/%EC%9B%B9-%ED%81%AC%EB%A1%A4%EB%A7%81-I)

 ìœ„ ê¸€ì—ì„œë„ ë³¼ ìˆ˜ ìˆë“¯ í¬ë¡¤ë§ì´ë€ ì‘ì—…ì€ ì–´ë–¤ íŠ¹ì • ì •ë³´ë¥¼ ì°¾ê¸° ìœ„í•´ì„œ `ìë™í™”`í•˜ì—¬ `ì£¼ê¸°ì `ìœ¼ë¡œ ì›¹ ìƒì˜ í˜ì´ì§€ë“¤ì„ ëŒì•„ë‹¤ë‹ˆë©° `ìƒ‰ì¸/ë¶„ë¥˜`í•˜ê³  ì—…ë°ì´íŠ¸ëœ ë¶€ë¶„ì„ ì°¾ëŠ” ë“±ì˜ ë‹¤ì–‘í•˜ê³  ê³ ë„í™”ëœ ìë™í™” ê¸°ëŠ¥ì´ë¼ëŠ” ê²ƒì„ ë§í•œë‹¤.

 ì´ì™€ ë‹¬ë¦¬ ì›¹ ìŠ¤í¬ë˜í•‘ì€ ë‹¨ìˆœíˆ ì–´ë–¤ í˜ì´ì§€ì—ì„œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ë¶€ë¶„ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.


<br>

### project03 í™˜ê²½ ì„¸íŒ…

|Package            |Version|
|------------------|-----------|
|beautifulsoup4     |4.11.1     |
|bs4                |0.0.1      |
|certifi            |2022.6.15  |
|charset-normalizer |2.1.0      |
|click              |8.1.3      |
|colorama           |0.4.5      |
|dnspython          |2.2.1      |
|Flask              |2.1.2      |
|idna               |3.3|
|importlib-metadata |4.12.0|
|itsdangerous       |2.1.2|
|Jinja2             |3.1.2|
|MarkupSafe         |2.1.1|
|pip                |20.2.1|
|pymongo            |4.1.1|
|requests           |2.28.1|
|setuptools         |49.2.1|
|soupsieve          |2.3.2.post1|
|urllib3            |1.26.9|
|Werkzeug           |2.1.2|
|zipp               |3.8.0|

<br>

### seleniumì„ í™œìš©í•œ ìŠ¤í¬ë˜í•‘

 -> ë©œë¡ ê³¼ ê°™ì€ ë™ì ì¸ ì‚¬ì´íŠ¸ë¥¼ ìŠ¤í¬ë˜í•‘í•  ë•ŒëŠ” ê°’ì´ ì •í™•í•˜ê²Œ ë‚˜ì˜¤ì§€ ì•Šê²Œ ëœë‹¤. ì˜ˆë¥¼ë“¤ì–´ ë©œë¡ ì˜ like ì¢‹ì•„ìš” ê°’ì€ ë™ì ì´ë¯€ë¡œ ë‹¨ìˆœíˆ ë‹¤ìŒ ì½”ë“œë¡œ ë¶ˆëŸ¬ì˜¬ ë•Œ ê°’ì´ ì œëŒ€ë¡œ ì•ˆë“¤ì–´ì˜¤ê²Œëœë‹¤.

![image](https://user-images.githubusercontent.com/84966961/179012019-ab1a964b-80b6-4298-a197-ce2feefce097.png)

 ```python
 url = "https://www.melon.com/chart/day/index.htm"
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
data = requests.get(url, headers=headers)

req = data.text
soup = BeautifulSoup(req, 'html.parser')

songs = soup.select("#frm > div > table > tbody > tr")
print(len(songs))

for song in songs:
    title = song.select_one("td > div > div.wrap_song_info > div.rank01 > span > a").text
    artist = song.select_one("td > div > div.wrap_song_info > div.rank02 > span > a").text
    likes = song.select_one("td > div > button.like > span.cnt").text
    print(title, artist, likes)
```

 ê³ ë¡œ jinja2 ì™€ ê°™ì´ ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ ë°©ì‹ì´ ì•„ë‹Œ html ë‚´ë¶€ì˜ ê°’ë“¤ì„ ê¸ì–´ì˜¬ ìˆ˜ ì—†ë‹¤. ê·¸ë ‡ê¸°ì— í˜ì´ì§€ ë Œë”ë§ì„ ìœ„í•´ì„œ ì›¹ë¸Œë¼ìš°ì €ë¥¼ í†µì œí•  ìˆ˜ ìˆëŠ” seleniumì„ ì‚¬ìš©í•˜ì—¬ í¬ë¡¬ ë“œë¼ì´ë²„ë¥¼ ê¹”ê³  ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆë„ë¡ í•œë‹¤.


<br>

 ### selenium ì‚¬ìš© ì„¸íŒ…

 1. í¬ë¡¬ ë“œë¼ì´ë²„ë¥¼ ê¹”ê¸° ìœ„í•´ í˜„ì¬ í¬ë¡¬ ë¸Œë¼ìš°ì € ë²„ì „ì„ í™•ì¸í•œë‹¤.(`chrome://settings/help`ì—ì„œ í™•ì¸ê°€ëŠ¥)
    - ë³¸ì¸ ë²„ì „ì€ `ë²„ì „ 103.0.5060.114(ê³µì‹ ë¹Œë“œ) (64ë¹„íŠ¸)`ì´ë‹¤.
 2. `https://chromedriver.storage.googleapis.com/index.html` ë“œë¼ì´ë²„ ì‚¬ì´íŠ¸ì—ì„œ ë³¸ì¸ ë²„ì „ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ë“œë¼ì´ë²„ë¥¼ ê° ìš´ì˜ì²´ì œì— ë§ê²Œ ë‹¤ìš´ë°›ì•„ ì„¤ì¹˜í•œë‹¤.
 3. ë°›ì€ ë“œë¼ì´ë²„ë¥¼ ì‚¬ìš©í•  `scraping.py` íŒŒì¼ê³¼ ê°™ì€ ê²½ë¡œì— ë„£ì–´ì¤€ë‹¤.
 4. ìŠ¤í¬ë˜í•‘ íŒŒì¼ì„ ì‹¤í–‰í•œë‹¤.

<br>

 ### selenium ì‚¬ìš©

ë“œë¼ì´ë²„ê°€ ê° urlì„ ì ‘ì†í•˜ì—¬ ê¸°ë‹¤ë ¸ë‹¤ htmlì„ ë°›ì•„ ì¢…ë£Œí•œë‹¤.(ë™ì  ë°ì´í„°ë¥¼ ëª¨ë‘ ë°›ì€ htmlì„ ë°›ì•„ì˜¤ê¸° ìœ„í•´ì„œ) ì‹¤ì œë¡œ ë“œë¼ì´ë²„ê°€ ì‘ë™ë˜ë©´ í¬ë¡¬ì´ ì¼œì¡Œë‹¤ êº¼ì§€ê²Œ ëœë‹¤.

```python
driver.get(url)  # ë“œë¼ì´ë²„ì— í•´ë‹¹ urlì˜ ì›¹í˜ì´ì§€ë¥¼ ë„ì›ë‹ˆë‹¤.
sleep(5)  # í˜ì´ì§€ê°€ ë¡œë”©ë˜ëŠ” ë™ì•ˆ 5ì´ˆ ê°„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.

req = driver.page_source  # html ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
driver.quit()  # ì •ë³´ë¥¼ ê°€ì ¸ì™”ìœ¼ë¯€ë¡œ ë“œë¼ì´ë²„ëŠ” êº¼ì¤ë‹ˆë‹¤.
```

ì‹¤ì œ ë°ì´í„° ì¶œë ¥ë¨.

```text
100
ê·¸ë•Œ ê·¸ ìˆœê°„ ê·¸ëŒ€ë¡œ (ê·¸ê·¸ê·¸) WSGì›Œë„ˆë¹„ (ê°€ì•¼G) 
ì´ê±´ìˆ˜
54,849
ë³´ê³ ì‹¶ì—ˆì–´ WSGì›Œë„ˆë¹„ (4FIRE) 
ì´ê±´ìˆ˜
50,349
LOVE DIVE IVE (ì•„ì´ë¸Œ) 
ì´ê±´ìˆ˜
162,855
```

html êµ¬ì¡°ë¥¼ ë¶„ë¦¬í•˜ì—¬ stringë§Œ ë°›ì•„ì˜¤ëŠ” ë°©ë²•ì´ë‹¤. ë¨¼ì € `decompose()`ë¡œ íƒœê·¸ë¥¼ ë‚ ë¦¬ê³ , `strip()`ìœ¼ë¡œ ê³µë°±ì„ ì—†ì• ì„œ ë‹¤ìŒ ì½”ë“œ ê²°ê³¼ì™€ ê°™ì´ ë³´ì´ê²Œ í•œë‹¤.
```python
for song in songs:
    title = song.select_one("td > div > div.wrap_song_info > div.rank01 > span > a").text
    artist = song.select_one("td > div > div.wrap_song_info > div.rank02 > span > a").text
    likes_tag = song.select_one("td > div > button.like > span.cnt")
    likes_tag.span.decompose()  # span íƒœê·¸ ì—†ì• ê¸°
    likes = likes_tag.text.strip()  # í…ìŠ¤íŠ¸í™”í•œ í›„ ì•ë’¤ë¡œ ë¹ˆ ì¹¸ ì§€ìš°ê¸°
    print(title, artist, likes)
```
```text
100
ê·¸ë•Œ ê·¸ ìˆœê°„ ê·¸ëŒ€ë¡œ (ê·¸ê·¸ê·¸) WSGì›Œë„ˆë¹„ (ê°€ì•¼G) 54,856
ë³´ê³ ì‹¶ì—ˆì–´ WSGì›Œë„ˆë¹„ (4FIRE) 50,355
LOVE DIVE IVE (ì•„ì´ë¸Œ) 162,855
```

<hr>

ê°™ì€ ë°©ë²•ìœ¼ë¡œ naver imageë¥¼ ê²€ìƒ‰í•´ì„œ ê° ì´ë¯¸ì§€ì˜ html ì£¼ì†Œê°’ì„ ë°›ì•„ì˜¬ ìˆ˜ë„ ìˆë‹¤. íŠ¹íˆ ì´ëŸ° ìƒí™©ì—ì„œ í˜ì„ ë°œíœ˜í•˜ëŠ”ë° êµ¬ê¸€ì´ë‚˜ ë„¤ì´ë²„ì—ì„œ ì´ë¯¸ì§€ë¥¼ ê²€ìƒ‰í•  ê²½ìš° ë¬´í•œ ìŠ¤í¬ë¡¤ ë°©ì‹ì„ ì´ìš©í•´ì„œ ìŠ¤í¬ë¡¤ì„ ë‚´ë¦¼ì— ë”°ë¼ì„œ ë°˜ì‘í˜•ìœ¼ë¡œ ì´ë¯¸ì§€ë“¤ì´ append ë˜ëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. seleniumê³¼ í¬ë¡¬ ë“œë¼ì´ë²„ë¥¼ í™œìš©í•˜ì—¬ ì°½ì„ í‚¤ê³  3ì´ˆ ê¸°ë‹¤ë¦° í›„ 1000í”½ì…€ ë‚´ë ¤ì„œ ìƒˆë¡œìš´ ì´ë¯¸ì§€ë¥¼ ë¶€ë¥´ê³  1ì´ˆí›„ì— ë‹¤ì‹œ í•´ë‹¹ ì°½ì˜ ë ìŠ¤í¬ë¡¤ê¹Œì§€ ë‚´ë ¤ ì´ë¯¸ì§€ë¥¼ ë” ë°›ëŠ” ë°©ë²•ì„ ë‹¤ìŒ ì½”ë“œì™€ ê°™ì´ í•  ìˆ˜ ìˆë‹¤.

```python
driver = webdriver.Chrome('./chromedriver')

url = "https://search.naver.com/search.naver?where=image&sm=tab_jum&query=%EC%95%84%EC%9D%B4%EC%9C%A0"
driver.get(url)
sleep(3)
driver.execute_script("window.scrollTo(0, 1000)")  # 1000í”½ì…€ë§Œí¼ ë‚´ë¦¬ê¸° -> ì´ë¯¸ì§€ê°€ ìƒˆë¡œìƒê¹€
sleep(1)
driver.execute_script("window.scrollTo(0, document.body.scrollHeight);") # í˜„ì¬ ìŠ¤í¬ë¡¤ ëê¹Œì§€ ë‚´ë¦¬ê¸° -> ìƒˆë¡œìš´ ì´ë¯¸ì§€ë“¤ì´ ë˜ ê²€ìƒ‰ë¨
sleep(10)

req = driver.page_source
driver.quit()

soup = BeautifulSoup(req, 'html.parser')
images = soup.select(".tile_item._item ._image._listImage")
print(len(images))

for image in images:
    src = image["src"]
    print(src)
```

<br>

